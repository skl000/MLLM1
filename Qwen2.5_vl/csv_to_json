import pandas as pd
import json

# 载入CSV文件
df = pd.read_csv(r'/home/work301/vsc_projects/MLLM1/Qwen2.5_vl/coco_2014_caption/coco-2024-dataset.csv')
conversations = []

# 添加对话数据
for i in range(len(df)):
    conversations.append({
        "id": f"identity_{i+1}",
        "conversations": [
            {
                "from": "user",
                "value": f"COCO Yes: <|vision_start|>{df.iloc[i]['image_path']}<|vision_end|>"
            },
            {
                "from": "assistant", 
                "value": df.iloc[i]['caption']
            }
        ]
    })

# 保存为json
with open(r'/home/work301/vsc_projects/MLLM1/Qwen2.5_vl/coco_2014_caption/coco-2024-dataset.json', 'w', encoding='utf-8') as f:
    json.dump(conversations, f, ensure_ascii=False, indent=2)